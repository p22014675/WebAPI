<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Manga</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        td, th {
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #f2f2f2;
        }
        #coverArt {
            width: 450px;
            height: 800px;
            object-fit: cover; /* Ensures the image covers the entire area without distortion */
        }
    </style>
</head>
<body>
    <div id="randomMangaContainer">
        <h2>Random Manga</h2>
        <button onclick="fetchRandomManga()">Get Random Manga</button>
        <table>
            <tr>
                <td rowspan="2"><img id="coverArt" src="" alt="Cover Art"></td> <!-- Image tag for cover art -->
                <td id="mangaTitle"><strong>Title:</strong> </td>
            </tr>
            <tr>
                <td id="mangaDescription"><strong>Description:</strong> </td>
            </tr>
        </table>
    </div>

    <script>
        function fetchRandomManga() {
            // Construct URL with query parameters
            const url = '/api/random?includes[]=manga&includes[]=cover_art&includes[]=author&includes[]=artist&includes[]=tag&includes[]=creator&contentRating[]=safe&contentRating[]=suggestive&contentRating[]=erotica&includedTagsMode=AND';

            fetch(url)
                .then(response => response.json()) // Convert response to JSON
                .then(data => {
                    // Extract manga details
                    const mangaTitle = data.attributes.title.en;
                    const mangaDescription = data.attributes.description.en || 'No description available';
                    const coverArtUrl = data.coverArtUrl;

                    // Update cover art image source if available
                    if (coverArtUrl) {
                        document.getElementById('coverArt').src = coverArtUrl;
                    } else {
                        document.getElementById('coverArt').src = '';
                        console.error('Cover art URL not found in response');
                    }

                    // Update manga title and description
                    document.getElementById('mangaTitle').innerHTML = `<strong>Title:</strong> ${mangaTitle}`;
                    document.getElementById('mangaDescription').innerHTML = `<strong>Description:</strong> ${mangaDescription}`;
                })
                .catch(error => console.error('Error fetching random manga:', error));
        }
    </script>
</body>
</html>
